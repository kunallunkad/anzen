import{d as w,r,s as c,j as e,C as _}from"./index-D377iWu2.js";import{f as y}from"./dateFormat-E6B5rKFz.js";import{D as R}from"./download-Cw744MUe.js";import{T as I}from"./trending-down-DzuVIicJ.js";import{T as S}from"./Layout-B5e6WOHT.js";function E(){const{t}=w(),[o,N]=r.useState([]),[p,f]=r.useState([]),[d,g]=r.useState([]),[P,m]=r.useState(!0),[i,j]=r.useState("summary"),[l,D]=r.useState("");r.useEffect(()=>{b()},[]);const b=async()=>{try{m(!0);const[a,s,x]=await Promise.all([c.from("vw_monthly_tax_summary").select("*").order("month",{ascending:!1}),c.from("vw_input_ppn_report").select("*"),c.from("vw_output_ppn_report").select("*")]);if(a.error)throw a.error;if(s.error)throw s.error;if(x.error)throw x.error;g(a.data||[]),N(s.data||[]),f(x.data||[])}catch(a){console.error("Error loading tax reports:",a.message),alert("Failed to load tax reports")}finally{m(!1)}},n=a=>`Rp ${a==null?void 0:a.toLocaleString("id-ID",{minimumFractionDigits:2,maximumFractionDigits:2})}`,v=a=>a?new Date(a).toLocaleDateString("en-US",{year:"numeric",month:"long"}):"-",u=l?o.filter(a=>a.month===l):o,h=l?p.filter(a=>a.month===l):p;return e.jsxs("div",{className:"space-y-2",children:[e.jsxs("div",{className:"flex items-center justify-between bg-white p-2 rounded-lg shadow-sm",children:[e.jsxs("div",{children:[e.jsx("h2",{className:"text-sm font-semibold text-gray-900",children:t("finance.taxReports")||"Tax Reports (PPN)"}),e.jsx("p",{className:"text-[10px] text-gray-600",children:t("finance.taxReportsDesc")||"Monthly Input PPN, Output PPN, Net PPN"})]}),e.jsxs("button",{onClick:()=>window.print(),className:"flex items-center gap-1.5 px-2.5 py-1.5 border border-gray-300 rounded-lg hover:bg-gray-50 text-xs",children:[e.jsx(R,{className:"w-3.5 h-3.5"}),t("common.print")||"Print"]})]}),e.jsx("div",{className:"flex gap-1.5 border-b border-gray-200 bg-white",children:[{value:"summary",label:t("finance.monthlySummary")||"Monthly Summary",icon:_},{value:"input",label:t("finance.inputPPN")||"Input PPN",icon:I},{value:"output",label:t("finance.outputPPN")||"Output PPN",icon:S}].map(a=>{const s=a.icon;return e.jsxs("button",{onClick:()=>j(a.value),className:`flex items-center gap-1.5 px-2.5 py-1.5 text-xs font-medium transition-colors ${i===a.value?"text-blue-600 border-b-2 border-blue-600":"text-gray-500 hover:text-gray-700"}`,children:[e.jsx(s,{className:"w-3.5 h-3.5"}),a.label]},a.value)})}),P?e.jsx("div",{className:"text-center py-8 text-gray-500 text-xs",children:t("common.loading")||"Loading tax reports..."}):e.jsxs(e.Fragment,{children:[i==="summary"&&e.jsxs("div",{className:"bg-white rounded-lg shadow overflow-hidden",children:[e.jsxs("div",{className:"px-3 py-2 bg-gray-50 border-b border-gray-200",children:[e.jsx("h3",{className:"text-sm font-medium text-gray-900",children:t("finance.monthlySummary")||"Monthly Tax Summary"}),e.jsx("p",{className:"text-[10px] text-gray-600",children:t("finance.netPPNFormula")||"Net PPN = Output PPN - Input PPN"})]}),e.jsxs("table",{className:"min-w-full divide-y divide-gray-200",children:[e.jsx("thead",{className:"bg-gray-50",children:e.jsxs("tr",{children:[e.jsx("th",{className:"px-3 py-1.5 text-left text-[10px] font-medium text-gray-500 uppercase",children:t("common.month")||"Month"}),e.jsx("th",{className:"px-3 py-1.5 text-right text-[10px] font-medium text-gray-500 uppercase",children:t("finance.inputPPNPaid")||"Input PPN"}),e.jsx("th",{className:"px-3 py-1.5 text-right text-[10px] font-medium text-gray-500 uppercase",children:t("finance.outputPPNCollected")||"Output PPN"}),e.jsx("th",{className:"px-3 py-1.5 text-right text-[10px] font-medium text-gray-500 uppercase",children:t("finance.netPPNPayable")||"Net PPN Payable"})]})}),e.jsx("tbody",{className:"bg-white divide-y divide-gray-200",children:d.length===0?e.jsx("tr",{children:e.jsx("td",{colSpan:4,className:"px-3 py-4 text-center text-gray-500 text-xs",children:t("common.noData")||"No tax data available"})}):d.map((a,s)=>e.jsxs("tr",{className:"hover:bg-gray-50",children:[e.jsx("td",{className:"px-3 py-2 whitespace-nowrap",children:e.jsx("div",{className:"text-xs font-medium text-gray-900",children:v(a.month)})}),e.jsx("td",{className:"px-3 py-2 whitespace-nowrap text-right",children:e.jsx("div",{className:"text-xs text-blue-600 font-medium",children:n(a.input_ppn_paid)})}),e.jsx("td",{className:"px-3 py-2 whitespace-nowrap text-right",children:e.jsx("div",{className:"text-xs text-green-600 font-medium",children:n(a.output_ppn_collected)})}),e.jsxs("td",{className:"px-3 py-2 whitespace-nowrap text-right",children:[e.jsx("div",{className:`text-xs font-bold ${a.net_ppn_payable>0?"text-red-600":a.net_ppn_payable<0?"text-blue-600":"text-gray-600"}`,children:n(a.net_ppn_payable)}),e.jsx("div",{className:"text-[10px] text-gray-500",children:a.net_ppn_payable>0?t("finance.payToTax")||"Pay to tax office":a.net_ppn_payable<0?t("finance.carryForward")||"Carry forward":t("finance.balanced")||"Balanced"})]})]},s))})]})]}),i==="input"&&e.jsxs("div",{className:"bg-white rounded-lg shadow overflow-hidden",children:[e.jsxs("div",{className:"px-3 py-2 bg-blue-50 border-b border-blue-200",children:[e.jsx("h3",{className:"text-sm font-medium text-blue-900",children:t("finance.inputPPNReport")||"Input PPN Report"}),e.jsx("p",{className:"text-[10px] text-blue-700",children:t("finance.inputPPNDesc")||"PPN paid on imports - can be claimed as tax credit"})]}),e.jsx("div",{className:"overflow-x-auto",children:e.jsxs("table",{className:"min-w-full divide-y divide-gray-200",children:[e.jsx("thead",{className:"bg-gray-50",children:e.jsxs("tr",{children:[e.jsx("th",{className:"px-3 py-1.5 text-left text-[10px] font-medium text-gray-500 uppercase",children:t("common.date")||"Date"}),e.jsx("th",{className:"px-3 py-1.5 text-left text-[10px] font-medium text-gray-500 uppercase",children:t("common.container")||"Container"}),e.jsx("th",{className:"px-3 py-1.5 text-left text-[10px] font-medium text-gray-500 uppercase",children:t("common.supplier")||"Supplier"}),e.jsx("th",{className:"px-3 py-1.5 text-right text-[10px] font-medium text-gray-500 uppercase",children:t("finance.invoiceValue")||"Invoice Value"}),e.jsx("th",{className:"px-3 py-1.5 text-right text-[10px] font-medium text-gray-500 uppercase",children:t("finance.ppnAmount")||"PPN Amount (11%)"})]})}),e.jsx("tbody",{className:"bg-white divide-y divide-gray-200",children:u.length===0?e.jsx("tr",{children:e.jsx("td",{colSpan:5,className:"px-3 py-4 text-center text-gray-500 text-xs",children:t("common.noRecords")||"No input PPN records"})}):u.map((a,s)=>e.jsxs("tr",{className:"hover:bg-gray-50",children:[e.jsx("td",{className:"px-3 py-2 whitespace-nowrap text-xs text-gray-900",children:y(a.expense_date)}),e.jsx("td",{className:"px-3 py-2 whitespace-nowrap text-xs font-medium text-gray-900",children:a.container_ref}),e.jsx("td",{className:"px-3 py-2 text-xs text-gray-700",children:a.supplier}),e.jsx("td",{className:"px-3 py-2 whitespace-nowrap text-xs text-right text-gray-900",children:n(a.import_invoice_value)}),e.jsx("td",{className:"px-3 py-2 whitespace-nowrap text-xs text-right font-medium text-blue-600",children:n(a.ppn_amount)})]},s))})]})})]}),i==="output"&&e.jsxs("div",{className:"bg-white rounded-lg shadow overflow-hidden",children:[e.jsxs("div",{className:"px-3 py-2 bg-green-50 border-b border-green-200",children:[e.jsx("h3",{className:"text-sm font-medium text-green-900",children:t("finance.outputPPNReport")||"Output PPN Report"}),e.jsx("p",{className:"text-[10px] text-green-700",children:t("finance.outputPPNDesc")||"PPN collected from customers - must be paid to tax office"}),e.jsx("p",{className:"text-[10px] font-semibold text-red-700 mt-1",children:t("finance.taxPayableWarning")||"‚ö†Ô∏è Tax is payable based on INVOICE DATE, not payment status!"})]}),e.jsx("div",{className:"overflow-x-auto",children:e.jsxs("table",{className:"min-w-full divide-y divide-gray-200",children:[e.jsx("thead",{className:"bg-gray-50",children:e.jsxs("tr",{children:[e.jsx("th",{className:"px-3 py-1.5 text-left text-[10px] font-medium text-gray-500 uppercase",children:t("common.date")||"Date"}),e.jsx("th",{className:"px-3 py-1.5 text-left text-[10px] font-medium text-gray-500 uppercase",children:t("common.invoiceNo")||"Invoice #"}),e.jsx("th",{className:"px-3 py-1.5 text-left text-[10px] font-medium text-gray-500 uppercase",children:t("common.customer")||"Customer"}),e.jsx("th",{className:"px-3 py-1.5 text-left text-[10px] font-medium text-gray-500 uppercase",children:"NPWP"}),e.jsx("th",{className:"px-3 py-1.5 text-right text-[10px] font-medium text-gray-500 uppercase",children:t("finance.subtotal")||"Subtotal"}),e.jsx("th",{className:"px-3 py-1.5 text-right text-[10px] font-medium text-gray-500 uppercase",children:t("finance.ppnAmount")||"PPN Amount (11%)"}),e.jsxs("th",{className:"px-3 py-1.5 text-center text-[10px] font-medium text-gray-500 uppercase",children:[t("common.paymentStatus")||"Payment Status",e.jsx("div",{className:"text-[10px] font-normal text-gray-500 normal-case",children:t("finance.forInfoOnly")||"(For info only - tax due regardless)"})]})]})}),e.jsx("tbody",{className:"bg-white divide-y divide-gray-200",children:h.length===0?e.jsx("tr",{children:e.jsx("td",{colSpan:7,className:"px-3 py-4 text-center text-gray-500 text-xs",children:t("common.noRecords")||"No output PPN records"})}):h.map((a,s)=>e.jsxs("tr",{className:"hover:bg-gray-50",children:[e.jsx("td",{className:"px-3 py-2 whitespace-nowrap text-xs text-gray-900",children:y(a.invoice_date)}),e.jsx("td",{className:"px-3 py-2 whitespace-nowrap text-xs font-medium text-gray-900",children:a.invoice_number}),e.jsx("td",{className:"px-3 py-2 text-xs text-gray-700",children:a.customer}),e.jsx("td",{className:"px-3 py-2 text-xs text-gray-600",children:a.customer_npwp||"-"}),e.jsx("td",{className:"px-3 py-2 whitespace-nowrap text-xs text-right text-gray-900",children:n(a.subtotal)}),e.jsx("td",{className:"px-3 py-2 whitespace-nowrap text-xs text-right font-medium text-green-600",children:n(a.ppn_amount)}),e.jsx("td",{className:"px-3 py-2 whitespace-nowrap text-center",children:e.jsx("span",{className:`inline-flex px-1.5 py-0.5 text-[10px] font-medium rounded ${a.payment_status==="paid"?"bg-green-100 text-green-800":a.payment_status==="partial"?"bg-yellow-100 text-yellow-800":"bg-gray-100 text-gray-800"}`,children:a.payment_status})})]},s))})]})})]})]}),e.jsxs("div",{className:"bg-red-50 border border-red-300 rounded-lg p-2",children:[e.jsx("h4",{className:"text-xs font-semibold text-red-900 mb-1",children:t("finance.taxRuleWarning")||"‚ö†Ô∏è CRITICAL: Indonesian PPN Tax Rule"}),e.jsxs("div",{className:"text-[10px] text-red-800 space-y-1",children:[e.jsx("p",{className:"font-semibold",children:t("finance.ppnPayableRule")||"PPN is payable based on INVOICE DATE, NOT payment date!"}),e.jsxs("ul",{className:"list-disc list-inside space-y-0.5 ml-1",children:[e.jsx("li",{children:t("finance.taxRule1")||"When you issue an invoice ‚Üí PPN is immediately owed to tax office"}),e.jsx("li",{children:t("finance.taxRule2")||"Payment status does NOT matter for tax"}),e.jsx("li",{children:t("finance.taxRule3")||"You must pay PPN to government even if customer hasn't paid you yet"}),e.jsx("li",{children:t("finance.taxRule4")||"All invoices in a month = PPN payable for that month"})]})]})]}),e.jsxs("div",{className:"bg-blue-50 border border-blue-200 rounded-lg p-2",children:[e.jsx("h4",{className:"text-xs font-semibold text-blue-900 mb-1",children:t("finance.taxFilingGuide")||"üìã Tax Filing Guide"}),e.jsxs("ul",{className:"text-[10px] text-blue-800 space-y-0.5",children:[e.jsxs("li",{children:["‚Ä¢ ",e.jsx("strong",{children:t("finance.inputPPN")||"Input PPN"}),": ",t("finance.inputPPNDesc2")||"PPN paid on imports (can be claimed back)"]}),e.jsxs("li",{children:["‚Ä¢ ",e.jsx("strong",{children:t("finance.outputPPN")||"Output PPN"}),": ",t("finance.outputPPNDesc2")||"PPN collected from customers (must pay to tax office)"]}),e.jsxs("li",{children:["‚Ä¢ ",e.jsx("strong",{children:t("finance.netPPNPayable")||"Net PPN Payable"}),": ",t("finance.netPPNFormula2")||"Output PPN - Input PPN"]}),e.jsxs("li",{children:["‚Ä¢ ",t("finance.taxRule5")||"If positive: Pay to tax office by month-end"]}),e.jsxs("li",{children:["‚Ä¢ ",t("finance.taxRule6")||"If negative: Carry forward to next month or claim refund"]}),e.jsxs("li",{children:["‚Ä¢ ",e.jsx("strong",{children:t("finance.ppnRate")||"PPN Rate"}),": 11% ",t("finance.asPerLaw")||"(as per Indonesian tax law)"]})]})]})]})}export{E as TaxReports};
