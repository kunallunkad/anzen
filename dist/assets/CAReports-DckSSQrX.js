import{u as H,m as J,r as f,s as u,j as e,F as y}from"./index-D377iWu2.js";import{u as j,w as Q}from"./xlsx-CKN5doRT.js";import{B as R}from"./building-2-D6r6vIE5.js";import{T as K,P as Y}from"./Layout-B5e6WOHT.js";import{D as X}from"./download-Cw744MUe.js";import"./dateFormat-E6B5rKFz.js";function se(){var D;const{profile:z}=H(),{dateRange:g}=J(),[p,T]=f.useState("inventory_movement"),[b,v]=f.useState(!1),[m,S]=f.useState(null),[A,F]=f.useState(null),d={from:g.startDate,to:g.endDate},C=[{id:"coa",name:"Chart of Accounts",icon:y,description:"Complete COA list"},{id:"cash_ledger",name:"Cash Ledger",icon:y,description:"Cash on Hand & Petty Cash"},{id:"bank_ledger",name:"Bank Ledger",icon:R,description:"All bank accounts"},{id:"sales_register",name:"Sales Register",icon:K,description:"All sales invoices"},{id:"purchase_register",name:"Purchase Register",icon:y,description:"All purchase invoices"},{id:"inventory_movement",name:"Inventory Movement",icon:Y,description:"Stock Opening + In + Out + Closing",highlight:!0},{id:"journal_register",name:"Journal Register",icon:y,description:"All journal entries"},{id:"general_ledger",name:"General Ledger",icon:y,description:"All account ledgers combined"},{id:"trial_balance",name:"Trial Balance",icon:y,description:"Debit/Credit summary"},{id:"fixed_assets",name:"Fixed Asset Register",icon:R,description:"Assets with depreciation"}];f.useEffect(()=>{p&&k()},[p,g.startDate,g.endDate]);const k=async()=>{v(!0),F(null);try{let t=null;switch(p){case"coa":t=await I();break;case"cash_ledger":t=await P();break;case"bank_ledger":t=await q();break;case"sales_register":t=await L();break;case"purchase_register":t=await $();break;case"inventory_movement":t=await O();break;case"journal_register":t=await B();break;case"general_ledger":t=await M();break;case"trial_balance":t=await G();break;case"fixed_assets":t=await V();break}S(t)}catch(t){console.error("Error loading report:",t),F(t.message||"Failed to load report")}finally{v(!1)}},I=async()=>{const{data:t,error:r}=await u.from("chart_of_accounts").select("code, name, account_type").order("code");if(r)throw r;return t||[]},P=async()=>{const{data:t}=await u.from("chart_of_accounts").select("id, code, name").in("code",["1101","1102"]);if(!t||t.length===0)return[];const r=t.map(c=>c.id),{data:s}=await u.from("journal_entries").select("id, entry_date, entry_number, source_module").gte("entry_date",d.from).lte("entry_date",d.to).order("entry_date",{ascending:!0});if(!s||s.length===0)return[];const i=s.map(c=>c.id),{data:n,error:l}=await u.from("journal_entry_lines").select("journal_entry_id, account_id, debit, credit, description").in("journal_entry_id",i).in("account_id",r);if(l)throw l;return(n==null?void 0:n.map(c=>{const x=s.find(_=>_.id===c.journal_entry_id),h=t.find(_=>_.id===c.account_id);return{date:x==null?void 0:x.entry_date,voucher_no:x==null?void 0:x.entry_number,account_name:h==null?void 0:h.name,debit:c.debit,credit:c.credit,narration:c.description}}))||[]},q=async()=>{const{data:t}=await u.from("chart_of_accounts").select("id, code, name").like("code","1111%");if(!t||t.length===0)return[];const r=t.map(c=>c.id),{data:s}=await u.from("journal_entries").select("id, entry_date, entry_number, source_module").gte("entry_date",d.from).lte("entry_date",d.to).order("entry_date",{ascending:!0});if(!s||s.length===0)return[];const i=s.map(c=>c.id),{data:n,error:l}=await u.from("journal_entry_lines").select("journal_entry_id, account_id, debit, credit, description").in("journal_entry_id",i).in("account_id",r);if(l)throw l;return(n==null?void 0:n.map(c=>{const x=s.find(_=>_.id===c.journal_entry_id),h=t.find(_=>_.id===c.account_id);return{date:x==null?void 0:x.entry_date,voucher_no:x==null?void 0:x.entry_number,account_name:h==null?void 0:h.name,debit:c.debit,credit:c.credit,narration:c.description}}))||[]},L=async()=>{const{data:t,error:r}=await u.from("sales_invoices").select(`
        invoice_number,
        invoice_date,
        customer_id,
        subtotal,
        tax_amount,
        total_amount,
        faktur_pajak_number,
        customers(company_name)
      `).gte("invoice_date",d.from).lte("invoice_date",d.to).order("invoice_date",{ascending:!0});if(r)throw r;return(t==null?void 0:t.map(s=>{var i;return{invoice_date:s.invoice_date,invoice_number:s.invoice_number,customer_name:(i=s.customers)==null?void 0:i.company_name,tax_invoice_no:s.faktur_pajak_number,net_amount:s.subtotal,ppn:s.tax_amount,total_amount:s.total_amount}}))||[]},$=async()=>{const{data:t,error:r}=await u.from("purchase_orders").select(`
        po_number,
        po_date,
        supplier_id,
        subtotal,
        tax_amount,
        total_amount,
        currency,
        suppliers(company_name)
      `).gte("po_date",d.from).lte("po_date",d.to).order("po_date",{ascending:!0});if(r)throw r;return(t==null?void 0:t.map(s=>{var i;return{po_date:s.po_date,po_number:s.po_number,supplier_name:(i=s.suppliers)==null?void 0:i.company_name,net_amount:s.subtotal,ppn:s.tax_amount,total_amount:s.total_amount,currency:s.currency}}))||[]},O=async()=>{const{data:t}=await u.from("inventory_transactions").select(`
        product_id,
        quantity,
        transaction_type
      `).lt("transaction_date",d.from),{data:r}=await u.from("inventory_transactions").select(`
        product_id,
        transaction_date,
        quantity,
        transaction_type,
        reference_type,
        reference_number
      `).gte("transaction_date",d.from).lte("transaction_date",d.to),{data:s}=await u.from("products").select("id, product_code, product_name, unit");if(!s)return[];const i=new Map;return s.forEach(n=>{i.set(n.id,{product_code:n.product_code,product_name:n.product_name,unit:n.unit||"PCS",opening:0,in_qty:0,out_qty:0,closing:0})}),t==null||t.forEach(n=>{if(i.has(n.product_id)){const l=i.get(n.product_id);n.quantity>0,l.opening+=parseFloat(n.quantity)}}),r==null||r.forEach(n=>{if(i.has(n.product_id)){const l=i.get(n.product_id);parseFloat(n.quantity)>0?l.in_qty+=parseFloat(n.quantity):l.out_qty+=Math.abs(parseFloat(n.quantity))}}),Array.from(i.values()).forEach(n=>{n.closing=n.opening+n.in_qty-n.out_qty}),Array.from(i.values())},B=async()=>{const{data:t}=await u.from("journal_entries").select("id, entry_date, entry_number, source_module, description").gte("entry_date",d.from).lte("entry_date",d.to).order("entry_date",{ascending:!0}).order("entry_number",{ascending:!0});if(!t||t.length===0)return[];const r=t.map(o=>o.id),{data:s}=await u.from("journal_entry_lines").select("journal_entry_id, line_number, account_id, debit, credit, description").in("journal_entry_id",r).order("line_number",{ascending:!0}),{data:i}=await u.from("chart_of_accounts").select("id, code, name"),n=new Map((i==null?void 0:i.map(o=>[o.id,o]))||[]);return(s==null?void 0:s.map(o=>{const c=t.find(h=>h.id===o.journal_entry_id),x=n.get(o.account_id);return{entry_date:c==null?void 0:c.entry_date,entry_number:c==null?void 0:c.entry_number,voucher_type:c==null?void 0:c.source_module,account_code:x==null?void 0:x.code,account_name:x==null?void 0:x.name,debit:o.debit,credit:o.credit,narration:o.description||(c==null?void 0:c.description)}}))||[]},M=async()=>{const{data:t}=await u.from("journal_entries").select("id, entry_date, entry_number, source_module").gte("entry_date",d.from).lte("entry_date",d.to);if(!t||t.length===0)return[];const r=t.map(o=>o.id),{data:s}=await u.from("journal_entry_lines").select("journal_entry_id, account_id, debit, credit, description").in("journal_entry_id",r),{data:i}=await u.from("chart_of_accounts").select("id, code, name, account_type"),n=new Map((i==null?void 0:i.map(o=>[o.id,o]))||[]);return((s==null?void 0:s.map(o=>{const c=t.find(h=>h.id===o.journal_entry_id),x=n.get(o.account_id);return{account_code:x==null?void 0:x.code,account_name:x==null?void 0:x.name,entry_date:c==null?void 0:c.entry_date,voucher_number:c==null?void 0:c.entry_number,debit:o.debit,credit:o.credit,description:o.description}}))||[]).sort((o,c)=>o.account_code!==c.account_code?(o.account_code||"").localeCompare(c.account_code||""):(o.entry_date||"").localeCompare(c.entry_date||""))},G=async()=>{const{data:t}=await u.from("journal_entries").select("id").gte("entry_date",d.from).lte("entry_date",d.to);if(!t||t.length===0)return[];const r=t.map(l=>l.id),{data:s}=await u.from("journal_entry_lines").select("account_id, debit, credit").in("journal_entry_id",r),{data:i}=await u.from("chart_of_accounts").select("id, code, name, account_type"),n=new Map;return i==null||i.forEach(l=>{n.set(l.id,{code:l.code,name:l.name,account_type:l.account_type,debit:0,credit:0})}),s==null||s.forEach(l=>{if(n.has(l.account_id)){const o=n.get(l.account_id);o.debit+=parseFloat(l.debit||0),o.credit+=parseFloat(l.credit||0)}}),Array.from(n.values()).filter(l=>l.debit!==0||l.credit!==0).sort((l,o)=>l.code.localeCompare(o.code))},V=async()=>{const{data:t,error:r}=await u.from("chart_of_accounts").select("code, name").gte("code","1500").lt("code","2000").order("code");if(r)throw r;return(t==null?void 0:t.map(s=>({asset_code:s.code,asset_name:s.name,acquisition_date:"",cost:"",accumulated_depreciation:"",net_book_value:""})))||[]},U=async()=>{if(!m||m.length===0){alert("No data to export");return}const{data:t}=await u.from("app_settings").select("company_name").limit(1).maybeSingle(),r=(t==null?void 0:t.company_name)||"Your Company Name";let s=[],i="",n="",l=!1;switch(p){case"coa":n="CHART OF ACCOUNTS",s=m.map(a=>({"Account Code":a.code,"Account Name":a.name,"Account Type":a.account_type})),i="Chart_of_Accounts.xlsx";break;case"inventory_movement":n="INVENTORY MOVEMENT REPORT",l=!0,s=m.map(a=>({"Product Code":a.product_code,"Product Name":a.product_name,Unit:a.unit,"Opening Qty":a.opening,"Qty In":a.in_qty,"Qty Out":a.out_qty,"Closing Qty":a.closing})),i=`Inventory_Movement_${d.from}_to_${d.to}.xlsx`;break;case"sales_register":n="SALES REGISTER",l=!0,s=m.map(a=>({Date:a.invoice_date,"Invoice No":a.invoice_number,Customer:a.customer_name,"Tax Invoice No":a.tax_invoice_no,"Net Amount":a.net_amount,PPN:a.ppn,Total:a.total_amount})),i=`Sales_Register_${d.from}_to_${d.to}.xlsx`;break;case"purchase_register":n="PURCHASE REGISTER",l=!0,s=m.map(a=>({Date:a.po_date,"PO Number":a.po_number,Supplier:a.supplier_name,"Net Amount":a.net_amount,PPN:a.ppn,Total:a.total_amount,Currency:a.currency})),i=`Purchase_Register_${d.from}_to_${d.to}.xlsx`;break;case"journal_register":n="JOURNAL REGISTER",l=!0,s=m.map(a=>({Date:a.entry_date,"Entry No":a.entry_number,"Voucher Type":a.voucher_type,"Account Code":a.account_code,"Account Name":a.account_name,Debit:a.debit,Credit:a.credit,Narration:a.narration})),i=`Journal_Register_${d.from}_to_${d.to}.xlsx`;break;case"general_ledger":n="GENERAL LEDGER",l=!0,s=m.map(a=>({"Account Code":a.account_code,"Account Name":a.account_name,Date:a.entry_date,"Voucher No":a.voucher_number,Debit:a.debit,Credit:a.credit,Description:a.description})),i=`General_Ledger_${d.from}_to_${d.to}.xlsx`;break;case"trial_balance":n="TRIAL BALANCE",l=!0,s=m.map(a=>({"Account Code":a.code,"Account Name":a.name,Debit:a.debit,Credit:a.credit})),i=`Trial_Balance_${d.from}_to_${d.to}.xlsx`;break;case"cash_ledger":n="CASH LEDGER",l=!0,s=m.map(a=>({Date:a.date,"Voucher No":a.voucher_no,Account:a.account_name,Debit:a.debit,Credit:a.credit,Narration:a.narration})),i=`Cash_Ledger_${d.from}_to_${d.to}.xlsx`;break;case"bank_ledger":n="BANK LEDGER",l=!0,s=m.map(a=>({Date:a.date,"Voucher No":a.voucher_no,"Bank Account":a.account_name,Debit:a.debit,Credit:a.credit,Narration:a.narration})),i=`Bank_Ledger_${d.from}_to_${d.to}.xlsx`;break;case"fixed_assets":n="FIXED ASSET REGISTER",s=m.map(a=>({"Asset Code":a.asset_code,"Asset Name":a.asset_name,"Acquisition Date":a.acquisition_date,Cost:a.cost,"Accumulated Depreciation":a.accumulated_depreciation,"Net Book Value":a.net_book_value})),i="Fixed_Asset_Register.xlsx";break}const o=[[r],[n]];if(l){const a=new Date(d.from).toLocaleDateString("en-GB"),N=new Date(d.to).toLocaleDateString("en-GB");o.push([`Period: ${a} to ${N}`])}o.push([]);const c=Object.keys(s[0]||{}),x=s.map(a=>c.map(N=>a[N])),h=[...o,c,...x],_=j.aoa_to_sheet(h);_["!cols"]=c.map(()=>({wch:15}));const E=j.book_new();j.book_append_sheet(E,_,"Report"),Q(E,i)};return e.jsxs("div",{className:"space-y-6",children:[e.jsx("div",{className:"flex items-center justify-between",children:e.jsx("h2",{className:"text-2xl font-bold text-slate-900",children:"CA Reports - Tax Consultant Excel Exports"})}),e.jsx("div",{className:"grid grid-cols-5 gap-4",children:C.map(t=>{const r=t.icon;return e.jsxs("button",{onClick:()=>T(t.id),className:`p-4 rounded-lg border-2 text-left transition-all ${p===t.id?"border-emerald-500 bg-emerald-50":t.highlight?"border-amber-500 bg-amber-50 hover:border-amber-600":"border-slate-200 bg-white hover:border-slate-300"}`,children:[e.jsx(r,{className:`w-6 h-6 mb-2 ${p===t.id?"text-emerald-600":t.highlight?"text-amber-600":"text-slate-600"}`}),e.jsx("h3",{className:"font-semibold text-sm text-slate-900",children:t.name}),e.jsx("p",{className:"text-xs text-slate-500 mt-1",children:t.description})]},t.id)})}),e.jsxs("div",{className:"bg-white rounded-lg border border-slate-200 p-6",children:[e.jsxs("div",{className:"flex items-center justify-between mb-4",children:[e.jsx("h3",{className:"text-lg font-semibold text-slate-900",children:(D=C.find(t=>t.id===p))==null?void 0:D.name}),e.jsxs("button",{onClick:U,disabled:b||!m||m.length===0,className:"px-4 py-2 bg-emerald-600 text-white rounded-lg hover:bg-emerald-700 disabled:opacity-50 disabled:cursor-not-allowed flex items-center gap-2",children:[e.jsx(X,{className:"w-4 h-4"}),"Export to Excel"]})]}),b?e.jsx("div",{className:"text-center py-12 text-slate-500",children:"Loading report..."}):A?e.jsxs("div",{className:"text-center py-12",children:[e.jsx("div",{className:"text-red-600 font-semibold mb-2",children:"Error Loading Report"}),e.jsx("div",{className:"text-slate-600",children:A}),e.jsx("button",{onClick:k,className:"mt-4 px-4 py-2 bg-blue-600 text-white rounded hover:bg-blue-700",children:"Retry"})]}):!m||m.length===0?e.jsx("div",{className:"text-center py-12 text-slate-500",children:"No data available for selected period"}):e.jsxs("div",{className:"overflow-x-auto max-h-[600px] overflow-y-auto",children:[e.jsxs("div",{className:"text-sm text-slate-600 mb-2",children:[m.length," record(s) found"]}),e.jsxs("table",{className:"min-w-full divide-y divide-slate-200 text-sm",children:[e.jsx("thead",{className:"bg-slate-50 sticky top-0",children:e.jsxs("tr",{children:[p==="inventory_movement"&&e.jsxs(e.Fragment,{children:[e.jsx("th",{className:"px-4 py-3 text-left font-medium text-slate-700",children:"Product Code"}),e.jsx("th",{className:"px-4 py-3 text-left font-medium text-slate-700",children:"Product Name"}),e.jsx("th",{className:"px-4 py-3 text-left font-medium text-slate-700",children:"Unit"}),e.jsx("th",{className:"px-4 py-3 text-right font-medium text-slate-700",children:"Opening"}),e.jsx("th",{className:"px-4 py-3 text-right font-medium text-slate-700 bg-green-50",children:"In"}),e.jsx("th",{className:"px-4 py-3 text-right font-medium text-slate-700 bg-red-50",children:"Out"}),e.jsx("th",{className:"px-4 py-3 text-right font-medium text-slate-700 bg-blue-50",children:"Closing"})]}),p==="coa"&&e.jsxs(e.Fragment,{children:[e.jsx("th",{className:"px-4 py-3 text-left font-medium text-slate-700",children:"Code"}),e.jsx("th",{className:"px-4 py-3 text-left font-medium text-slate-700",children:"Account Name"}),e.jsx("th",{className:"px-4 py-3 text-left font-medium text-slate-700",children:"Type"})]}),p==="sales_register"&&e.jsxs(e.Fragment,{children:[e.jsx("th",{className:"px-4 py-3 text-left font-medium text-slate-700",children:"Date"}),e.jsx("th",{className:"px-4 py-3 text-left font-medium text-slate-700",children:"Invoice No"}),e.jsx("th",{className:"px-4 py-3 text-left font-medium text-slate-700",children:"Customer"}),e.jsx("th",{className:"px-4 py-3 text-left font-medium text-slate-700",children:"Tax Invoice"}),e.jsx("th",{className:"px-4 py-3 text-right font-medium text-slate-700",children:"Net"}),e.jsx("th",{className:"px-4 py-3 text-right font-medium text-slate-700",children:"PPN"}),e.jsx("th",{className:"px-4 py-3 text-right font-medium text-slate-700",children:"Total"})]}),p==="purchase_register"&&e.jsxs(e.Fragment,{children:[e.jsx("th",{className:"px-4 py-3 text-left font-medium text-slate-700",children:"Date"}),e.jsx("th",{className:"px-4 py-3 text-left font-medium text-slate-700",children:"PO No"}),e.jsx("th",{className:"px-4 py-3 text-left font-medium text-slate-700",children:"Supplier"}),e.jsx("th",{className:"px-4 py-3 text-right font-medium text-slate-700",children:"Net"}),e.jsx("th",{className:"px-4 py-3 text-right font-medium text-slate-700",children:"PPN"}),e.jsx("th",{className:"px-4 py-3 text-right font-medium text-slate-700",children:"Total"}),e.jsx("th",{className:"px-4 py-3 text-left font-medium text-slate-700",children:"Currency"})]}),p==="cash_ledger"&&e.jsxs(e.Fragment,{children:[e.jsx("th",{className:"px-4 py-3 text-left font-medium text-slate-700",children:"Date"}),e.jsx("th",{className:"px-4 py-3 text-left font-medium text-slate-700",children:"Voucher No"}),e.jsx("th",{className:"px-4 py-3 text-left font-medium text-slate-700",children:"Account"}),e.jsx("th",{className:"px-4 py-3 text-right font-medium text-slate-700",children:"Debit"}),e.jsx("th",{className:"px-4 py-3 text-right font-medium text-slate-700",children:"Credit"}),e.jsx("th",{className:"px-4 py-3 text-left font-medium text-slate-700",children:"Narration"})]}),p==="bank_ledger"&&e.jsxs(e.Fragment,{children:[e.jsx("th",{className:"px-4 py-3 text-left font-medium text-slate-700",children:"Date"}),e.jsx("th",{className:"px-4 py-3 text-left font-medium text-slate-700",children:"Voucher No"}),e.jsx("th",{className:"px-4 py-3 text-left font-medium text-slate-700",children:"Bank Account"}),e.jsx("th",{className:"px-4 py-3 text-right font-medium text-slate-700",children:"Debit"}),e.jsx("th",{className:"px-4 py-3 text-right font-medium text-slate-700",children:"Credit"}),e.jsx("th",{className:"px-4 py-3 text-left font-medium text-slate-700",children:"Narration"})]}),p==="journal_register"&&e.jsxs(e.Fragment,{children:[e.jsx("th",{className:"px-4 py-3 text-left font-medium text-slate-700",children:"Date"}),e.jsx("th",{className:"px-4 py-3 text-left font-medium text-slate-700",children:"Entry No"}),e.jsx("th",{className:"px-4 py-3 text-left font-medium text-slate-700",children:"Voucher Type"}),e.jsx("th",{className:"px-4 py-3 text-left font-medium text-slate-700",children:"Account Code"}),e.jsx("th",{className:"px-4 py-3 text-left font-medium text-slate-700",children:"Account Name"}),e.jsx("th",{className:"px-4 py-3 text-right font-medium text-slate-700",children:"Debit"}),e.jsx("th",{className:"px-4 py-3 text-right font-medium text-slate-700",children:"Credit"}),e.jsx("th",{className:"px-4 py-3 text-left font-medium text-slate-700",children:"Narration"})]}),p==="general_ledger"&&e.jsxs(e.Fragment,{children:[e.jsx("th",{className:"px-4 py-3 text-left font-medium text-slate-700",children:"Account Code"}),e.jsx("th",{className:"px-4 py-3 text-left font-medium text-slate-700",children:"Account Name"}),e.jsx("th",{className:"px-4 py-3 text-left font-medium text-slate-700",children:"Date"}),e.jsx("th",{className:"px-4 py-3 text-left font-medium text-slate-700",children:"Voucher No"}),e.jsx("th",{className:"px-4 py-3 text-right font-medium text-slate-700",children:"Debit"}),e.jsx("th",{className:"px-4 py-3 text-right font-medium text-slate-700",children:"Credit"}),e.jsx("th",{className:"px-4 py-3 text-left font-medium text-slate-700",children:"Description"})]}),p==="trial_balance"&&e.jsxs(e.Fragment,{children:[e.jsx("th",{className:"px-4 py-3 text-left font-medium text-slate-700",children:"Code"}),e.jsx("th",{className:"px-4 py-3 text-left font-medium text-slate-700",children:"Account Name"}),e.jsx("th",{className:"px-4 py-3 text-right font-medium text-slate-700",children:"Debit"}),e.jsx("th",{className:"px-4 py-3 text-right font-medium text-slate-700",children:"Credit"})]}),p==="fixed_assets"&&e.jsxs(e.Fragment,{children:[e.jsx("th",{className:"px-4 py-3 text-left font-medium text-slate-700",children:"Asset Code"}),e.jsx("th",{className:"px-4 py-3 text-left font-medium text-slate-700",children:"Asset Name"}),e.jsx("th",{className:"px-4 py-3 text-left font-medium text-slate-700",children:"Acquisition Date"}),e.jsx("th",{className:"px-4 py-3 text-right font-medium text-slate-700",children:"Cost"}),e.jsx("th",{className:"px-4 py-3 text-right font-medium text-slate-700",children:"Acc. Depreciation"}),e.jsx("th",{className:"px-4 py-3 text-right font-medium text-slate-700",children:"Net Book Value"})]})]})}),e.jsxs("tbody",{className:"bg-white divide-y divide-slate-200",children:[p==="inventory_movement"&&m.slice(0,100).map((t,r)=>e.jsxs("tr",{className:"hover:bg-slate-50",children:[e.jsx("td",{className:"px-4 py-3 text-slate-900",children:t.product_code}),e.jsx("td",{className:"px-4 py-3 text-slate-900",children:t.product_name}),e.jsx("td",{className:"px-4 py-3 text-slate-600",children:t.unit}),e.jsx("td",{className:"px-4 py-3 text-right text-slate-900",children:t.opening}),e.jsx("td",{className:"px-4 py-3 text-right text-green-600 bg-green-50",children:t.in_qty}),e.jsx("td",{className:"px-4 py-3 text-right text-red-600 bg-red-50",children:t.out_qty}),e.jsx("td",{className:"px-4 py-3 text-right font-semibold text-blue-600 bg-blue-50",children:t.closing})]},r)),p==="coa"&&m.map((t,r)=>e.jsxs("tr",{className:"hover:bg-slate-50",children:[e.jsx("td",{className:"px-4 py-3 text-slate-900 font-mono",children:t.code}),e.jsx("td",{className:"px-4 py-3 text-slate-900",children:t.name}),e.jsx("td",{className:"px-4 py-3 text-slate-600",children:t.account_type})]},r)),p==="sales_register"&&m.slice(0,100).map((t,r)=>e.jsxs("tr",{className:"hover:bg-slate-50",children:[e.jsx("td",{className:"px-4 py-3 text-slate-900",children:t.invoice_date}),e.jsx("td",{className:"px-4 py-3 text-slate-900",children:t.invoice_number}),e.jsx("td",{className:"px-4 py-3 text-slate-900",children:t.customer_name}),e.jsx("td",{className:"px-4 py-3 text-slate-600",children:t.tax_invoice_no}),e.jsx("td",{className:"px-4 py-3 text-right text-slate-900",children:parseFloat(t.net_amount||0).toFixed(2)}),e.jsx("td",{className:"px-4 py-3 text-right text-slate-900",children:parseFloat(t.ppn||0).toFixed(2)}),e.jsx("td",{className:"px-4 py-3 text-right font-semibold text-slate-900",children:parseFloat(t.total_amount||0).toFixed(2)})]},r)),p==="purchase_register"&&m.slice(0,100).map((t,r)=>e.jsxs("tr",{className:"hover:bg-slate-50",children:[e.jsx("td",{className:"px-4 py-3 text-slate-900",children:t.po_date}),e.jsx("td",{className:"px-4 py-3 text-slate-900",children:t.po_number}),e.jsx("td",{className:"px-4 py-3 text-slate-900",children:t.supplier_name}),e.jsx("td",{className:"px-4 py-3 text-right text-slate-900",children:parseFloat(t.net_amount||0).toFixed(2)}),e.jsx("td",{className:"px-4 py-3 text-right text-slate-900",children:parseFloat(t.ppn||0).toFixed(2)}),e.jsx("td",{className:"px-4 py-3 text-right font-semibold text-slate-900",children:parseFloat(t.total_amount||0).toFixed(2)}),e.jsx("td",{className:"px-4 py-3 text-slate-600",children:t.currency})]},r)),p==="cash_ledger"&&m.slice(0,100).map((t,r)=>e.jsxs("tr",{className:"hover:bg-slate-50",children:[e.jsx("td",{className:"px-4 py-3 text-slate-900",children:t.date}),e.jsx("td",{className:"px-4 py-3 text-slate-900",children:t.voucher_no}),e.jsx("td",{className:"px-4 py-3 text-slate-900",children:t.account_name}),e.jsx("td",{className:"px-4 py-3 text-right text-slate-900",children:parseFloat(t.debit||0).toFixed(2)}),e.jsx("td",{className:"px-4 py-3 text-right text-slate-900",children:parseFloat(t.credit||0).toFixed(2)}),e.jsx("td",{className:"px-4 py-3 text-slate-600",children:t.narration})]},r)),p==="bank_ledger"&&m.slice(0,100).map((t,r)=>e.jsxs("tr",{className:"hover:bg-slate-50",children:[e.jsx("td",{className:"px-4 py-3 text-slate-900",children:t.date}),e.jsx("td",{className:"px-4 py-3 text-slate-900",children:t.voucher_no}),e.jsx("td",{className:"px-4 py-3 text-slate-900",children:t.account_name}),e.jsx("td",{className:"px-4 py-3 text-right text-slate-900",children:parseFloat(t.debit||0).toFixed(2)}),e.jsx("td",{className:"px-4 py-3 text-right text-slate-900",children:parseFloat(t.credit||0).toFixed(2)}),e.jsx("td",{className:"px-4 py-3 text-slate-600",children:t.narration})]},r)),p==="journal_register"&&m.slice(0,100).map((t,r)=>e.jsxs("tr",{className:"hover:bg-slate-50",children:[e.jsx("td",{className:"px-4 py-3 text-slate-900",children:t.entry_date}),e.jsx("td",{className:"px-4 py-3 text-slate-900",children:t.entry_number}),e.jsx("td",{className:"px-4 py-3 text-slate-600",children:t.voucher_type}),e.jsx("td",{className:"px-4 py-3 text-slate-900 font-mono",children:t.account_code}),e.jsx("td",{className:"px-4 py-3 text-slate-900",children:t.account_name}),e.jsx("td",{className:"px-4 py-3 text-right text-slate-900",children:parseFloat(t.debit||0).toFixed(2)}),e.jsx("td",{className:"px-4 py-3 text-right text-slate-900",children:parseFloat(t.credit||0).toFixed(2)}),e.jsx("td",{className:"px-4 py-3 text-slate-600",children:t.narration})]},r)),p==="general_ledger"&&m.slice(0,100).map((t,r)=>e.jsxs("tr",{className:"hover:bg-slate-50",children:[e.jsx("td",{className:"px-4 py-3 text-slate-900 font-mono",children:t.account_code}),e.jsx("td",{className:"px-4 py-3 text-slate-900",children:t.account_name}),e.jsx("td",{className:"px-4 py-3 text-slate-900",children:t.entry_date}),e.jsx("td",{className:"px-4 py-3 text-slate-900",children:t.voucher_number}),e.jsx("td",{className:"px-4 py-3 text-right text-slate-900",children:parseFloat(t.debit||0).toFixed(2)}),e.jsx("td",{className:"px-4 py-3 text-right text-slate-900",children:parseFloat(t.credit||0).toFixed(2)}),e.jsx("td",{className:"px-4 py-3 text-slate-600",children:t.description})]},r)),p==="trial_balance"&&m.slice(0,100).map((t,r)=>e.jsxs("tr",{className:"hover:bg-slate-50",children:[e.jsx("td",{className:"px-4 py-3 text-slate-900 font-mono",children:t.code}),e.jsx("td",{className:"px-4 py-3 text-slate-900",children:t.name}),e.jsx("td",{className:"px-4 py-3 text-right text-slate-900",children:parseFloat(t.debit||0).toFixed(2)}),e.jsx("td",{className:"px-4 py-3 text-right text-slate-900",children:parseFloat(t.credit||0).toFixed(2)})]},r)),p==="fixed_assets"&&m.slice(0,100).map((t,r)=>e.jsxs("tr",{className:"hover:bg-slate-50",children:[e.jsx("td",{className:"px-4 py-3 text-slate-900 font-mono",children:t.asset_code}),e.jsx("td",{className:"px-4 py-3 text-slate-900",children:t.asset_name}),e.jsx("td",{className:"px-4 py-3 text-slate-900",children:t.acquisition_date}),e.jsx("td",{className:"px-4 py-3 text-right text-slate-900",children:t.cost}),e.jsx("td",{className:"px-4 py-3 text-right text-slate-900",children:t.accumulated_depreciation}),e.jsx("td",{className:"px-4 py-3 text-right text-slate-900",children:t.net_book_value})]},r))]})]}),m.length>100&&e.jsxs("div",{className:"text-center py-4 text-slate-500 text-sm",children:["Showing first 100 records. Export to Excel to see all ",m.length," records."]})]})]})]})}export{se as CAReports};
