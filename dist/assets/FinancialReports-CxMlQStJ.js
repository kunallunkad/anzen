import{m as v,d as S,r,s as j,j as e}from"./index-05MON0zc.js";function I({initialReport:d="trial_balance"}){const{dateRange:n}=v(),{t:a}=S(),[l,y]=r.useState(d),[N,x]=r.useState(!1),[i,o]=r.useState([]);r.useEffect(()=>{D()},[l,n]),r.useEffect(()=>{y(d)},[d]);const D=async()=>{x(!0);try{const{data:t,error:s}=await j.rpc("get_trial_balance",{p_start_date:n.startDate,p_end_date:n.endDate});if(!s&&t)o(t);else{const{data:F,error:u}=await j.from("trial_balance_view").select("*").order("code");if(u)throw u;o(F||[])}}catch(t){console.error("Error loading report:",t)}finally{x(!1)}},m=i.reduce((t,s)=>({debit:t.debit+s.total_debit,credit:t.credit+s.total_credit}),{debit:0,credit:0}),p=i.filter(t=>t.account_type==="revenue").reduce((t,s)=>t+Math.abs(s.balance),0),h=i.filter(t=>t.account_type==="expense").reduce((t,s)=>t+Math.abs(s.balance),0),c=p-h,f=i.filter(t=>t.account_type==="asset").reduce((t,s)=>t+s.balance,0),_=i.filter(t=>{var s;return t.account_type==="contra"&&((s=t.account_group)==null?void 0:s.includes("Assets"))}).reduce((t,s)=>t+Math.abs(s.balance),0),g=i.filter(t=>t.account_type==="liability").reduce((t,s)=>t+Math.abs(s.balance),0),b=i.filter(t=>t.account_type==="equity").reduce((t,s)=>t+Math.abs(s.balance),0);return e.jsx("div",{children:N?e.jsx("div",{className:"flex justify-center py-8",children:e.jsx("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-blue-600"})}):e.jsxs(e.Fragment,{children:[l==="trial_balance"&&e.jsxs("div",{className:"bg-white rounded-lg shadow-sm border border-gray-200 overflow-hidden",children:[e.jsxs("div",{className:"px-4 py-3 border-b bg-gray-50",children:[e.jsxs("h3",{className:"font-bold text-base",children:["Trial Balance as of ",new Date(n.endDate).toLocaleDateString("id-ID")]}),e.jsxs("p",{className:"text-xs text-gray-600 italic",children:["Neraca Saldo per ",new Date(n.endDate).toLocaleDateString("id-ID")]})]}),e.jsxs("table",{className:"w-full",children:[e.jsx("thead",{className:"bg-gray-50",children:e.jsxs("tr",{children:[e.jsx("th",{className:"px-3 py-2 text-left text-[10px] font-medium text-gray-500 uppercase",children:a("code","Code")}),e.jsx("th",{className:"px-3 py-2 text-left text-[10px] font-medium text-gray-500 uppercase",children:a("account_name","Account Name")}),e.jsx("th",{className:"px-3 py-2 text-right text-[10px] font-medium text-gray-500 uppercase",children:a("debit","Debit")}),e.jsx("th",{className:"px-3 py-2 text-right text-[10px] font-medium text-gray-500 uppercase",children:a("credit","Credit")})]})}),e.jsxs("tbody",{className:"divide-y divide-gray-100",children:[i.map(t=>e.jsxs("tr",{className:"hover:bg-gray-50",children:[e.jsx("td",{className:"px-3 py-1.5 font-mono text-xs",children:t.code}),e.jsxs("td",{className:"px-3 py-1.5 text-sm",children:[e.jsx("div",{children:t.name}),t.name_id&&e.jsx("div",{className:"text-xs text-gray-500",children:t.name_id})]}),e.jsx("td",{className:"px-3 py-1.5 text-right text-sm text-blue-600",children:t.balance>0?`Rp ${t.balance.toLocaleString("id-ID",{minimumFractionDigits:2,maximumFractionDigits:2})}`:""}),e.jsx("td",{className:"px-3 py-1.5 text-right text-sm text-green-600",children:t.balance<0?`Rp ${Math.abs(t.balance).toLocaleString("id-ID",{minimumFractionDigits:2,maximumFractionDigits:2})}`:""})]},t.code)),i.length===0&&e.jsx("tr",{children:e.jsx("td",{colSpan:4,className:"px-3 py-6 text-center text-sm text-gray-500",children:a("no_data","No transactions found")})})]}),e.jsx("tfoot",{className:"bg-gray-100 font-bold",children:e.jsxs("tr",{children:[e.jsxs("td",{colSpan:2,className:"px-3 py-2 text-right text-sm",children:[a("total","Total"),":"]}),e.jsxs("td",{className:"px-3 py-2 text-right text-sm text-blue-700",children:["Rp ",m.debit.toLocaleString("id-ID",{minimumFractionDigits:2,maximumFractionDigits:2})]}),e.jsxs("td",{className:"px-3 py-2 text-right text-sm text-green-700",children:["Rp ",m.credit.toLocaleString("id-ID",{minimumFractionDigits:2,maximumFractionDigits:2})]})]})})]})]}),l==="pnl"&&e.jsxs("div",{className:"bg-white rounded-lg shadow-sm border border-gray-200 overflow-hidden",children:[e.jsxs("div",{className:"px-4 py-3 border-b bg-gray-50",children:[e.jsxs("h3",{className:"font-bold text-base",children:["Profit & Loss Statement for period ",new Date(n.startDate).toLocaleDateString("id-ID")," - ",new Date(n.endDate).toLocaleDateString("id-ID")]}),e.jsxs("p",{className:"text-xs text-gray-600 italic",children:["Laporan Laba Rugi periode ",new Date(n.startDate).toLocaleDateString("id-ID")," - ",new Date(n.endDate).toLocaleDateString("id-ID")]}),e.jsx("p",{className:"text-[10px] text-amber-600 mt-1 italic",children:a("pnl_note","Note: Costs may change as import expenses are updated")})]}),e.jsxs("div",{className:"p-3",children:[e.jsxs("div",{className:"mb-4",children:[e.jsxs("h4",{className:"font-semibold text-green-700 text-xs mb-1.5 border-b pb-1",children:[a("revenue","Revenue")," (Pendapatan)"]}),e.jsx("table",{className:"w-full",children:e.jsxs("tbody",{children:[i.filter(t=>t.account_type==="revenue").map(t=>e.jsxs("tr",{children:[e.jsx("td",{className:"py-0.5 font-mono text-[10px] text-gray-500",children:t.code}),e.jsx("td",{className:"py-0.5 text-xs",children:t.name}),e.jsxs("td",{className:"py-0.5 text-right text-xs text-green-600",children:["Rp ",Math.abs(t.balance).toLocaleString("id-ID",{minimumFractionDigits:2,maximumFractionDigits:2})]})]},t.code)),e.jsxs("tr",{className:"font-semibold border-t",children:[e.jsx("td",{colSpan:2,className:"py-1.5 text-xs",children:a("total_revenue","Total Revenue")}),e.jsxs("td",{className:"py-1.5 text-right text-xs text-green-700",children:["Rp ",p.toLocaleString("id-ID",{minimumFractionDigits:2,maximumFractionDigits:2})]})]})]})})]}),e.jsxs("div",{className:"mb-4",children:[e.jsxs("h4",{className:"font-semibold text-red-700 text-xs mb-1.5 border-b pb-1",children:[a("expenses","Expenses")," (Beban)"]}),e.jsx("table",{className:"w-full",children:e.jsxs("tbody",{children:[i.filter(t=>t.account_type==="expense").map(t=>e.jsxs("tr",{children:[e.jsx("td",{className:"py-0.5 font-mono text-[10px] text-gray-500",children:t.code}),e.jsx("td",{className:"py-0.5 text-xs",children:t.name}),e.jsxs("td",{className:"py-0.5 text-right text-xs text-red-600",children:["Rp ",Math.abs(t.balance).toLocaleString("id-ID",{minimumFractionDigits:2,maximumFractionDigits:2})]})]},t.code)),e.jsxs("tr",{className:"font-semibold border-t",children:[e.jsx("td",{colSpan:2,className:"py-1.5 text-xs",children:a("total_expenses","Total Expenses")}),e.jsxs("td",{className:"py-1.5 text-right text-xs text-red-700",children:["Rp ",h.toLocaleString("id-ID",{minimumFractionDigits:2,maximumFractionDigits:2})]})]})]})})]}),e.jsx("div",{className:`p-2.5 rounded ${c>=0?"bg-green-50":"bg-red-50"}`,children:e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsxs("span",{className:"font-bold text-sm",children:[a("net_income","Net Income")," ",e.jsxs("span",{className:"text-xs font-normal italic",children:["(",a("provisional","Provisional"),")"]})]}),e.jsxs("span",{className:`font-bold text-base ${c>=0?"text-green-700":"text-red-700"}`,children:["Rp ",c.toLocaleString("id-ID",{minimumFractionDigits:2,maximumFractionDigits:2})]})]})})]})]}),l==="balance_sheet"&&e.jsxs("div",{className:"bg-white rounded-lg shadow-sm border border-gray-200 overflow-hidden",children:[e.jsxs("div",{className:"px-4 py-3 border-b bg-gray-50",children:[e.jsxs("h3",{className:"font-bold text-base",children:["Balance Sheet as of ",new Date(n.endDate).toLocaleDateString("id-ID")]}),e.jsxs("p",{className:"text-xs text-gray-600 italic",children:["Neraca per ",new Date(n.endDate).toLocaleDateString("id-ID")]})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-3 p-3",children:[e.jsxs("div",{children:[e.jsxs("h4",{className:"font-semibold text-blue-700 text-xs mb-1.5 border-b pb-1",children:[a("assets","Assets")," (Aset)"]}),e.jsx("table",{className:"w-full",children:e.jsxs("tbody",{children:[i.filter(t=>t.account_type==="asset").map(t=>e.jsxs("tr",{children:[e.jsxs("td",{className:"py-0.5 text-xs",children:[e.jsx("span",{className:"font-mono text-[10px] text-gray-500 mr-1.5",children:t.code}),t.name]}),e.jsxs("td",{className:"py-0.5 text-right text-xs text-blue-600",children:["Rp ",t.balance.toLocaleString("id-ID",{minimumFractionDigits:2,maximumFractionDigits:2})]})]},t.code)),i.filter(t=>{var s;return t.account_type==="contra"&&((s=t.account_group)==null?void 0:s.includes("Assets"))}).map(t=>e.jsxs("tr",{className:"text-gray-500",children:[e.jsxs("td",{className:"py-0.5 text-xs",children:[e.jsx("span",{className:"font-mono text-[10px] mr-1.5",children:t.code}),t.name]}),e.jsxs("td",{className:"py-0.5 text-right text-xs",children:["(",Math.abs(t.balance).toLocaleString("id-ID",{minimumFractionDigits:2,maximumFractionDigits:2}),")"]})]},t.code)),e.jsxs("tr",{className:"font-semibold border-t-2",children:[e.jsx("td",{className:"py-1.5 text-xs",children:a("total_assets","Total Assets")}),e.jsxs("td",{className:"py-1.5 text-right text-xs text-blue-700",children:["Rp ",(f-_).toLocaleString("id-ID",{minimumFractionDigits:2,maximumFractionDigits:2})]})]})]})})]}),e.jsxs("div",{children:[e.jsxs("h4",{className:"font-semibold text-red-700 text-xs mb-1.5 border-b pb-1",children:[a("liabilities","Liabilities")," (Kewajiban)"]}),e.jsx("table",{className:"w-full",children:e.jsxs("tbody",{children:[i.filter(t=>t.account_type==="liability").map(t=>e.jsxs("tr",{children:[e.jsxs("td",{className:"py-0.5 text-xs",children:[e.jsx("span",{className:"font-mono text-[10px] text-gray-500 mr-1.5",children:t.code}),t.name]}),e.jsxs("td",{className:"py-0.5 text-right text-xs text-red-600",children:["Rp ",Math.abs(t.balance).toLocaleString("id-ID",{minimumFractionDigits:2,maximumFractionDigits:2})]})]},t.code)),e.jsxs("tr",{className:"font-semibold border-t",children:[e.jsx("td",{className:"py-1.5 text-xs",children:a("total_liabilities","Total Liabilities")}),e.jsxs("td",{className:"py-1.5 text-right text-xs text-red-700",children:["Rp ",g.toLocaleString("id-ID",{minimumFractionDigits:2,maximumFractionDigits:2})]})]})]})}),e.jsxs("h4",{className:"font-semibold text-purple-700 text-xs mb-1.5 border-b pb-1 mt-4",children:[a("equity","Equity")," (Modal)"]}),e.jsx("table",{className:"w-full",children:e.jsxs("tbody",{children:[i.filter(t=>t.account_type==="equity").map(t=>e.jsxs("tr",{children:[e.jsxs("td",{className:"py-0.5 text-xs",children:[e.jsx("span",{className:"font-mono text-[10px] text-gray-500 mr-1.5",children:t.code}),t.name]}),e.jsxs("td",{className:"py-0.5 text-right text-xs text-purple-600",children:["Rp ",Math.abs(t.balance).toLocaleString("id-ID",{minimumFractionDigits:2,maximumFractionDigits:2})]})]},t.code)),e.jsxs("tr",{children:[e.jsx("td",{className:"py-0.5 text-xs",children:a("current_year_earnings","Current Year Earnings")}),e.jsxs("td",{className:`py-0.5 text-right text-xs ${c>=0?"text-green-600":"text-red-600"}`,children:["Rp ",c.toLocaleString("id-ID",{minimumFractionDigits:2,maximumFractionDigits:2})]})]}),e.jsxs("tr",{className:"font-semibold border-t",children:[e.jsx("td",{className:"py-1.5 text-xs",children:a("total_equity","Total Equity")}),e.jsxs("td",{className:"py-1.5 text-right text-xs text-purple-700",children:["Rp ",(b+c).toLocaleString("id-ID",{minimumFractionDigits:2,maximumFractionDigits:2})]})]})]})}),e.jsx("div",{className:"mt-3 p-2 bg-gray-100 rounded",children:e.jsxs("div",{className:"flex justify-between font-bold text-xs",children:[e.jsx("span",{children:a("total_liabilities_equity","Total Liabilities + Equity")}),e.jsxs("span",{children:["Rp ",(g+b+c).toLocaleString("id-ID",{minimumFractionDigits:2,maximumFractionDigits:2})]})]})})]})]})]})]})})}export{I as FinancialReports};
