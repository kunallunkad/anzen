import{u as H,m as J,r as f,s as u,j as e,F as y}from"./index-05MON0zc.js";import{u as j,w as Q}from"./xlsx-CKN5doRT.js";import{B as E}from"./building-2-DBQXKMe1.js";import{T as K,P as W}from"./Layout-9pjiZa2A.js";import{D as Y}from"./download-DgYIVgez.js";import"./dateFormat-E6B5rKFz.js";function se(){var k;const{profile:X}=H(),{dateRange:g}=J(),[p,P]=f.useState("inventory_movement"),[b,v]=f.useState(!1),[m,S]=f.useState(null),[A,D]=f.useState(null),o={from:g.startDate,to:g.endDate},F=[{id:"coa",name:"Chart of Accounts",icon:y,description:"Complete COA list"},{id:"cash_ledger",name:"Cash Ledger",icon:y,description:"Cash on Hand & Petty Cash"},{id:"bank_ledger",name:"Bank Ledger",icon:E,description:"All bank accounts"},{id:"sales_register",name:"Sales Register",icon:K,description:"All sales invoices"},{id:"purchase_register",name:"Purchase Register",icon:y,description:"All purchase invoices"},{id:"inventory_movement",name:"Inventory Movement",icon:W,description:"Stock Opening + In + Out + Closing",highlight:!0},{id:"journal_register",name:"Journal Register",icon:y,description:"All journal entries"},{id:"general_ledger",name:"General Ledger",icon:y,description:"All account ledgers combined"},{id:"trial_balance",name:"Trial Balance",icon:y,description:"Debit/Credit summary"},{id:"fixed_assets",name:"Fixed Asset Register",icon:E,description:"Assets with depreciation"}];f.useEffect(()=>{p&&C()},[p,g.startDate,g.endDate]);const C=async()=>{v(!0),D(null);try{let t=null;switch(p){case"coa":t=await T();break;case"cash_ledger":t=await q();break;case"bank_ledger":t=await I();break;case"sales_register":t=await L();break;case"purchase_register":t=await $();break;case"inventory_movement":t=await O();break;case"journal_register":t=await B();break;case"general_ledger":t=await M();break;case"trial_balance":t=await G();break;case"fixed_assets":t=await V();break}S(t)}catch(t){console.error("Error loading report:",t),D(t.message||"Failed to load report")}finally{v(!1)}},T=async()=>{const{data:t,error:n}=await u.from("chart_of_accounts").select("code, name, account_type").order("code");if(n)throw n;return t||[]},q=async()=>{const{data:t}=await u.from("chart_of_accounts").select("id, code, name").in("code",["1101","1102"]);if(!t||t.length===0)return[];const n=t.map(i=>i.id),{data:c}=await u.from("journal_entries").select("id, entry_date, entry_number, source_module").gte("entry_date",o.from).lte("entry_date",o.to).order("entry_date",{ascending:!0});if(!c||c.length===0)return[];const r=c.map(i=>i.id),{data:s,error:l}=await u.from("journal_entry_lines").select("journal_entry_id, account_id, debit, credit, description").in("journal_entry_id",r).in("account_id",n);if(l)throw l;return(s==null?void 0:s.map(i=>{const x=c.find(_=>_.id===i.journal_entry_id),h=t.find(_=>_.id===i.account_id);return{date:x==null?void 0:x.entry_date,voucher_no:x==null?void 0:x.entry_number,account_name:h==null?void 0:h.name,debit:i.debit,credit:i.credit,narration:i.description}}))||[]},I=async()=>{const{data:t}=await u.from("chart_of_accounts").select("id, code, name").like("code","1111%");if(!t||t.length===0)return[];const n=t.map(i=>i.id),{data:c}=await u.from("journal_entries").select("id, entry_date, entry_number, source_module").gte("entry_date",o.from).lte("entry_date",o.to).order("entry_date",{ascending:!0});if(!c||c.length===0)return[];const r=c.map(i=>i.id),{data:s,error:l}=await u.from("journal_entry_lines").select("journal_entry_id, account_id, debit, credit, description").in("journal_entry_id",r).in("account_id",n);if(l)throw l;return(s==null?void 0:s.map(i=>{const x=c.find(_=>_.id===i.journal_entry_id),h=t.find(_=>_.id===i.account_id);return{date:x==null?void 0:x.entry_date,voucher_no:x==null?void 0:x.entry_number,account_name:h==null?void 0:h.name,debit:i.debit,credit:i.credit,narration:i.description}}))||[]},L=async()=>{const{data:t,error:n}=await u.from("sales_invoices").select(`
        id,
        invoice_number,
        invoice_date,
        due_date,
        customer_id,
        subtotal,
        tax_amount,
        total_amount,
        payment_status,
        customers(company_name)
      `).gte("invoice_date",o.from).lte("invoice_date",o.to).order("invoice_date",{ascending:!0});if(n)throw n;return await Promise.all((t||[]).map(async r=>{var l;const{data:s}=await u.rpc("get_invoice_latest_payment_date",{p_invoice_id:r.id});return{invoice_date:r.invoice_date,invoice_number:r.invoice_number,customer_name:(l=r.customers)==null?void 0:l.company_name,due_date:r.due_date,payment_receipt:s,payment_status:r.payment_status,net_amount:r.subtotal,ppn:r.tax_amount,total_amount:r.total_amount}}))},$=async()=>{const{data:t,error:n}=await u.from("purchase_orders").select(`
        po_number,
        po_date,
        supplier_id,
        subtotal,
        tax_amount,
        total_amount,
        currency,
        suppliers(company_name)
      `).gte("po_date",o.from).lte("po_date",o.to).order("po_date",{ascending:!0});if(n)throw n;return(t==null?void 0:t.map(c=>{var r;return{po_date:c.po_date,po_number:c.po_number,supplier_name:(r=c.suppliers)==null?void 0:r.company_name,net_amount:c.subtotal,ppn:c.tax_amount,total_amount:c.total_amount,currency:c.currency}}))||[]},O=async()=>{const{data:t}=await u.from("inventory_transactions").select(`
        product_id,
        quantity,
        transaction_type
      `).lt("transaction_date",o.from),{data:n}=await u.from("inventory_transactions").select(`
        product_id,
        transaction_date,
        quantity,
        transaction_type,
        reference_type,
        reference_number
      `).gte("transaction_date",o.from).lte("transaction_date",o.to),{data:c}=await u.from("products").select("id, product_code, product_name, unit");if(!c)return[];const r=new Map;return c.forEach(s=>{r.set(s.id,{product_code:s.product_code,product_name:s.product_name,unit:s.unit||"PCS",opening:0,in_qty:0,out_qty:0,closing:0})}),t==null||t.forEach(s=>{if(r.has(s.product_id)){const l=r.get(s.product_id);s.quantity>0,l.opening+=parseFloat(s.quantity)}}),n==null||n.forEach(s=>{if(r.has(s.product_id)){const l=r.get(s.product_id);parseFloat(s.quantity)>0?l.in_qty+=parseFloat(s.quantity):l.out_qty+=Math.abs(parseFloat(s.quantity))}}),Array.from(r.values()).forEach(s=>{s.closing=s.opening+s.in_qty-s.out_qty}),Array.from(r.values())},B=async()=>{const{data:t}=await u.from("journal_entries").select("id, entry_date, entry_number, source_module, description").gte("entry_date",o.from).lte("entry_date",o.to).order("entry_date",{ascending:!0}).order("entry_number",{ascending:!0});if(!t||t.length===0)return[];const n=t.map(d=>d.id),{data:c}=await u.from("journal_entry_lines").select("journal_entry_id, line_number, account_id, debit, credit, description").in("journal_entry_id",n).order("line_number",{ascending:!0}),{data:r}=await u.from("chart_of_accounts").select("id, code, name"),s=new Map((r==null?void 0:r.map(d=>[d.id,d]))||[]);return(c==null?void 0:c.map(d=>{const i=t.find(h=>h.id===d.journal_entry_id),x=s.get(d.account_id);return{entry_date:i==null?void 0:i.entry_date,entry_number:i==null?void 0:i.entry_number,voucher_type:i==null?void 0:i.source_module,account_code:x==null?void 0:x.code,account_name:x==null?void 0:x.name,debit:d.debit,credit:d.credit,narration:d.description||(i==null?void 0:i.description)}}))||[]},M=async()=>{const{data:t}=await u.from("journal_entries").select("id, entry_date, entry_number, source_module").gte("entry_date",o.from).lte("entry_date",o.to);if(!t||t.length===0)return[];const n=t.map(d=>d.id),{data:c}=await u.from("journal_entry_lines").select("journal_entry_id, account_id, debit, credit, description").in("journal_entry_id",n),{data:r}=await u.from("chart_of_accounts").select("id, code, name, account_type"),s=new Map((r==null?void 0:r.map(d=>[d.id,d]))||[]);return((c==null?void 0:c.map(d=>{const i=t.find(h=>h.id===d.journal_entry_id),x=s.get(d.account_id);return{account_code:x==null?void 0:x.code,account_name:x==null?void 0:x.name,entry_date:i==null?void 0:i.entry_date,voucher_number:i==null?void 0:i.entry_number,debit:d.debit,credit:d.credit,description:d.description}}))||[]).sort((d,i)=>d.account_code!==i.account_code?(d.account_code||"").localeCompare(i.account_code||""):(d.entry_date||"").localeCompare(i.entry_date||""))},G=async()=>{const{data:t}=await u.from("journal_entries").select("id").gte("entry_date",o.from).lte("entry_date",o.to);if(!t||t.length===0)return[];const n=t.map(l=>l.id),{data:c}=await u.from("journal_entry_lines").select("account_id, debit, credit").in("journal_entry_id",n),{data:r}=await u.from("chart_of_accounts").select("id, code, name, account_type"),s=new Map;return r==null||r.forEach(l=>{s.set(l.id,{code:l.code,name:l.name,account_type:l.account_type,debit:0,credit:0})}),c==null||c.forEach(l=>{if(s.has(l.account_id)){const d=s.get(l.account_id);d.debit+=parseFloat(l.debit||0),d.credit+=parseFloat(l.credit||0)}}),Array.from(s.values()).filter(l=>l.debit!==0||l.credit!==0).sort((l,d)=>l.code.localeCompare(d.code))},V=async()=>{const{data:t,error:n}=await u.from("chart_of_accounts").select("code, name").gte("code","1500").lt("code","2000").order("code");if(n)throw n;return(t==null?void 0:t.map(c=>({asset_code:c.code,asset_name:c.name,acquisition_date:"",cost:"",accumulated_depreciation:"",net_book_value:""})))||[]},U=async()=>{if(!m||m.length===0){alert("No data to export");return}const{data:t}=await u.from("app_settings").select("company_name").limit(1).maybeSingle(),n=(t==null?void 0:t.company_name)||"Your Company Name";let c=[],r="",s="",l=!1;switch(p){case"coa":s="CHART OF ACCOUNTS",c=m.map(a=>({"Account Code":a.code,"Account Name":a.name,"Account Type":a.account_type})),r="Chart_of_Accounts.xlsx";break;case"inventory_movement":s="INVENTORY MOVEMENT REPORT",l=!0,c=m.map(a=>({"Product Code":a.product_code,"Product Name":a.product_name,Unit:a.unit,"Opening Qty":a.opening,"Qty In":a.in_qty,"Qty Out":a.out_qty,"Closing Qty":a.closing})),r=`Inventory_Movement_${o.from}_to_${o.to}.xlsx`;break;case"sales_register":s="SALES REGISTER",l=!0,c=m.map(a=>({Date:a.invoice_date,"Invoice No":a.invoice_number,Customer:a.customer_name,"Due Date":a.payment_status==="paid"?"-":a.due_date,"Payment Receipt":a.payment_receipt||"-","Net Amount":a.net_amount,PPN:a.ppn,Total:a.total_amount})),r=`Sales_Register_${o.from}_to_${o.to}.xlsx`;break;case"purchase_register":s="PURCHASE REGISTER",l=!0,c=m.map(a=>({Date:a.po_date,"PO Number":a.po_number,Supplier:a.supplier_name,"Net Amount":a.net_amount,PPN:a.ppn,Total:a.total_amount,Currency:a.currency})),r=`Purchase_Register_${o.from}_to_${o.to}.xlsx`;break;case"journal_register":s="JOURNAL REGISTER",l=!0,c=m.map(a=>({Date:a.entry_date,"Entry No":a.entry_number,"Voucher Type":a.voucher_type,"Account Code":a.account_code,"Account Name":a.account_name,Debit:a.debit,Credit:a.credit,Narration:a.narration})),r=`Journal_Register_${o.from}_to_${o.to}.xlsx`;break;case"general_ledger":s="GENERAL LEDGER",l=!0,c=m.map(a=>({"Account Code":a.account_code,"Account Name":a.account_name,Date:a.entry_date,"Voucher No":a.voucher_number,Debit:a.debit,Credit:a.credit,Description:a.description})),r=`General_Ledger_${o.from}_to_${o.to}.xlsx`;break;case"trial_balance":s="TRIAL BALANCE",l=!0,c=m.map(a=>({"Account Code":a.code,"Account Name":a.name,Debit:a.debit,Credit:a.credit})),r=`Trial_Balance_${o.from}_to_${o.to}.xlsx`;break;case"cash_ledger":s="CASH LEDGER",l=!0,c=m.map(a=>({Date:a.date,"Voucher No":a.voucher_no,Account:a.account_name,Debit:a.debit,Credit:a.credit,Narration:a.narration})),r=`Cash_Ledger_${o.from}_to_${o.to}.xlsx`;break;case"bank_ledger":s="BANK LEDGER",l=!0,c=m.map(a=>({Date:a.date,"Voucher No":a.voucher_no,"Bank Account":a.account_name,Debit:a.debit,Credit:a.credit,Narration:a.narration})),r=`Bank_Ledger_${o.from}_to_${o.to}.xlsx`;break;case"fixed_assets":s="FIXED ASSET REGISTER",c=m.map(a=>({"Asset Code":a.asset_code,"Asset Name":a.asset_name,"Acquisition Date":a.acquisition_date,Cost:a.cost,"Accumulated Depreciation":a.accumulated_depreciation,"Net Book Value":a.net_book_value})),r="Fixed_Asset_Register.xlsx";break}const d=[[n],[s]];if(l){const a=new Date(o.from).toLocaleDateString("en-GB"),N=new Date(o.to).toLocaleDateString("en-GB");d.push([`Period: ${a} to ${N}`])}d.push([]);const i=Object.keys(c[0]||{}),x=c.map(a=>i.map(N=>a[N])),h=[...d,i,...x],_=j.aoa_to_sheet(h);_["!cols"]=i.map(()=>({wch:15}));const R=j.book_new();j.book_append_sheet(R,_,"Report"),Q(R,r)};return e.jsxs("div",{className:"space-y-6",children:[e.jsx("div",{className:"flex items-center justify-between",children:e.jsx("h2",{className:"text-2xl font-bold text-slate-900",children:"CA Reports - Tax Consultant Excel Exports"})}),e.jsx("div",{className:"grid grid-cols-5 gap-4",children:F.map(t=>{const n=t.icon;return e.jsxs("button",{onClick:()=>P(t.id),className:`p-4 rounded-lg border-2 text-left transition-all ${p===t.id?"border-emerald-500 bg-emerald-50":t.highlight?"border-amber-500 bg-amber-50 hover:border-amber-600":"border-slate-200 bg-white hover:border-slate-300"}`,children:[e.jsx(n,{className:`w-6 h-6 mb-2 ${p===t.id?"text-emerald-600":t.highlight?"text-amber-600":"text-slate-600"}`}),e.jsx("h3",{className:"font-semibold text-sm text-slate-900",children:t.name}),e.jsx("p",{className:"text-xs text-slate-500 mt-1",children:t.description})]},t.id)})}),e.jsxs("div",{className:"bg-white rounded-lg border border-slate-200 p-6",children:[e.jsxs("div",{className:"flex items-center justify-between mb-4",children:[e.jsx("h3",{className:"text-lg font-semibold text-slate-900",children:(k=F.find(t=>t.id===p))==null?void 0:k.name}),e.jsxs("button",{onClick:U,disabled:b||!m||m.length===0,className:"px-4 py-2 bg-emerald-600 text-white rounded-lg hover:bg-emerald-700 disabled:opacity-50 disabled:cursor-not-allowed flex items-center gap-2",children:[e.jsx(Y,{className:"w-4 h-4"}),"Export to Excel"]})]}),b?e.jsx("div",{className:"text-center py-12 text-slate-500",children:"Loading report..."}):A?e.jsxs("div",{className:"text-center py-12",children:[e.jsx("div",{className:"text-red-600 font-semibold mb-2",children:"Error Loading Report"}),e.jsx("div",{className:"text-slate-600",children:A}),e.jsx("button",{onClick:C,className:"mt-4 px-4 py-2 bg-blue-600 text-white rounded hover:bg-blue-700",children:"Retry"})]}):!m||m.length===0?e.jsx("div",{className:"text-center py-12 text-slate-500",children:"No data available for selected period"}):e.jsxs("div",{className:"overflow-x-auto max-h-[600px] overflow-y-auto",children:[e.jsxs("div",{className:"text-sm text-slate-600 mb-2",children:[m.length," record(s) found"]}),e.jsxs("table",{className:"min-w-full divide-y divide-slate-200 text-sm",children:[e.jsx("thead",{className:"bg-slate-50 sticky top-0",children:e.jsxs("tr",{children:[p==="inventory_movement"&&e.jsxs(e.Fragment,{children:[e.jsx("th",{className:"px-4 py-3 text-left font-medium text-slate-700",children:"Product Code"}),e.jsx("th",{className:"px-4 py-3 text-left font-medium text-slate-700",children:"Product Name"}),e.jsx("th",{className:"px-4 py-3 text-left font-medium text-slate-700",children:"Unit"}),e.jsx("th",{className:"px-4 py-3 text-right font-medium text-slate-700",children:"Opening"}),e.jsx("th",{className:"px-4 py-3 text-right font-medium text-slate-700 bg-green-50",children:"In"}),e.jsx("th",{className:"px-4 py-3 text-right font-medium text-slate-700 bg-red-50",children:"Out"}),e.jsx("th",{className:"px-4 py-3 text-right font-medium text-slate-700 bg-blue-50",children:"Closing"})]}),p==="coa"&&e.jsxs(e.Fragment,{children:[e.jsx("th",{className:"px-4 py-3 text-left font-medium text-slate-700",children:"Code"}),e.jsx("th",{className:"px-4 py-3 text-left font-medium text-slate-700",children:"Account Name"}),e.jsx("th",{className:"px-4 py-3 text-left font-medium text-slate-700",children:"Type"})]}),p==="sales_register"&&e.jsxs(e.Fragment,{children:[e.jsx("th",{className:"px-4 py-3 text-left font-medium text-slate-700",children:"Date"}),e.jsx("th",{className:"px-4 py-3 text-left font-medium text-slate-700",children:"Invoice No"}),e.jsx("th",{className:"px-4 py-3 text-left font-medium text-slate-700",children:"Customer"}),e.jsx("th",{className:"px-4 py-3 text-left font-medium text-slate-700",children:"Due Date"}),e.jsx("th",{className:"px-4 py-3 text-left font-medium text-slate-700",children:"Payment Receipt"}),e.jsx("th",{className:"px-4 py-3 text-right font-medium text-slate-700",children:"Net"}),e.jsx("th",{className:"px-4 py-3 text-right font-medium text-slate-700",children:"PPN"}),e.jsx("th",{className:"px-4 py-3 text-right font-medium text-slate-700",children:"Total"})]}),p==="purchase_register"&&e.jsxs(e.Fragment,{children:[e.jsx("th",{className:"px-4 py-3 text-left font-medium text-slate-700",children:"Date"}),e.jsx("th",{className:"px-4 py-3 text-left font-medium text-slate-700",children:"PO No"}),e.jsx("th",{className:"px-4 py-3 text-left font-medium text-slate-700",children:"Supplier"}),e.jsx("th",{className:"px-4 py-3 text-right font-medium text-slate-700",children:"Net"}),e.jsx("th",{className:"px-4 py-3 text-right font-medium text-slate-700",children:"PPN"}),e.jsx("th",{className:"px-4 py-3 text-right font-medium text-slate-700",children:"Total"}),e.jsx("th",{className:"px-4 py-3 text-left font-medium text-slate-700",children:"Currency"})]}),p==="cash_ledger"&&e.jsxs(e.Fragment,{children:[e.jsx("th",{className:"px-4 py-3 text-left font-medium text-slate-700",children:"Date"}),e.jsx("th",{className:"px-4 py-3 text-left font-medium text-slate-700",children:"Voucher No"}),e.jsx("th",{className:"px-4 py-3 text-left font-medium text-slate-700",children:"Account"}),e.jsx("th",{className:"px-4 py-3 text-right font-medium text-slate-700",children:"Debit"}),e.jsx("th",{className:"px-4 py-3 text-right font-medium text-slate-700",children:"Credit"}),e.jsx("th",{className:"px-4 py-3 text-left font-medium text-slate-700",children:"Narration"})]}),p==="bank_ledger"&&e.jsxs(e.Fragment,{children:[e.jsx("th",{className:"px-4 py-3 text-left font-medium text-slate-700",children:"Date"}),e.jsx("th",{className:"px-4 py-3 text-left font-medium text-slate-700",children:"Voucher No"}),e.jsx("th",{className:"px-4 py-3 text-left font-medium text-slate-700",children:"Bank Account"}),e.jsx("th",{className:"px-4 py-3 text-right font-medium text-slate-700",children:"Debit"}),e.jsx("th",{className:"px-4 py-3 text-right font-medium text-slate-700",children:"Credit"}),e.jsx("th",{className:"px-4 py-3 text-left font-medium text-slate-700",children:"Narration"})]}),p==="journal_register"&&e.jsxs(e.Fragment,{children:[e.jsx("th",{className:"px-4 py-3 text-left font-medium text-slate-700",children:"Date"}),e.jsx("th",{className:"px-4 py-3 text-left font-medium text-slate-700",children:"Entry No"}),e.jsx("th",{className:"px-4 py-3 text-left font-medium text-slate-700",children:"Voucher Type"}),e.jsx("th",{className:"px-4 py-3 text-left font-medium text-slate-700",children:"Account Code"}),e.jsx("th",{className:"px-4 py-3 text-left font-medium text-slate-700",children:"Account Name"}),e.jsx("th",{className:"px-4 py-3 text-right font-medium text-slate-700",children:"Debit"}),e.jsx("th",{className:"px-4 py-3 text-right font-medium text-slate-700",children:"Credit"}),e.jsx("th",{className:"px-4 py-3 text-left font-medium text-slate-700",children:"Narration"})]}),p==="general_ledger"&&e.jsxs(e.Fragment,{children:[e.jsx("th",{className:"px-4 py-3 text-left font-medium text-slate-700",children:"Account Code"}),e.jsx("th",{className:"px-4 py-3 text-left font-medium text-slate-700",children:"Account Name"}),e.jsx("th",{className:"px-4 py-3 text-left font-medium text-slate-700",children:"Date"}),e.jsx("th",{className:"px-4 py-3 text-left font-medium text-slate-700",children:"Voucher No"}),e.jsx("th",{className:"px-4 py-3 text-right font-medium text-slate-700",children:"Debit"}),e.jsx("th",{className:"px-4 py-3 text-right font-medium text-slate-700",children:"Credit"}),e.jsx("th",{className:"px-4 py-3 text-left font-medium text-slate-700",children:"Description"})]}),p==="trial_balance"&&e.jsxs(e.Fragment,{children:[e.jsx("th",{className:"px-4 py-3 text-left font-medium text-slate-700",children:"Code"}),e.jsx("th",{className:"px-4 py-3 text-left font-medium text-slate-700",children:"Account Name"}),e.jsx("th",{className:"px-4 py-3 text-right font-medium text-slate-700",children:"Debit"}),e.jsx("th",{className:"px-4 py-3 text-right font-medium text-slate-700",children:"Credit"})]}),p==="fixed_assets"&&e.jsxs(e.Fragment,{children:[e.jsx("th",{className:"px-4 py-3 text-left font-medium text-slate-700",children:"Asset Code"}),e.jsx("th",{className:"px-4 py-3 text-left font-medium text-slate-700",children:"Asset Name"}),e.jsx("th",{className:"px-4 py-3 text-left font-medium text-slate-700",children:"Acquisition Date"}),e.jsx("th",{className:"px-4 py-3 text-right font-medium text-slate-700",children:"Cost"}),e.jsx("th",{className:"px-4 py-3 text-right font-medium text-slate-700",children:"Acc. Depreciation"}),e.jsx("th",{className:"px-4 py-3 text-right font-medium text-slate-700",children:"Net Book Value"})]})]})}),e.jsxs("tbody",{className:"bg-white divide-y divide-slate-200",children:[p==="inventory_movement"&&m.slice(0,100).map((t,n)=>e.jsxs("tr",{className:"hover:bg-slate-50",children:[e.jsx("td",{className:"px-4 py-3 text-slate-900",children:t.product_code}),e.jsx("td",{className:"px-4 py-3 text-slate-900",children:t.product_name}),e.jsx("td",{className:"px-4 py-3 text-slate-600",children:t.unit}),e.jsx("td",{className:"px-4 py-3 text-right text-slate-900",children:t.opening}),e.jsx("td",{className:"px-4 py-3 text-right text-green-600 bg-green-50",children:t.in_qty}),e.jsx("td",{className:"px-4 py-3 text-right text-red-600 bg-red-50",children:t.out_qty}),e.jsx("td",{className:"px-4 py-3 text-right font-semibold text-blue-600 bg-blue-50",children:t.closing})]},n)),p==="coa"&&m.map((t,n)=>e.jsxs("tr",{className:"hover:bg-slate-50",children:[e.jsx("td",{className:"px-4 py-3 text-slate-900 font-mono",children:t.code}),e.jsx("td",{className:"px-4 py-3 text-slate-900",children:t.name}),e.jsx("td",{className:"px-4 py-3 text-slate-600",children:t.account_type})]},n)),p==="sales_register"&&m.slice(0,100).map((t,n)=>e.jsxs("tr",{className:"hover:bg-slate-50",children:[e.jsx("td",{className:"px-4 py-3 text-slate-900",children:t.invoice_date}),e.jsx("td",{className:"px-4 py-3 text-slate-900",children:t.invoice_number}),e.jsx("td",{className:"px-4 py-3 text-slate-900",children:t.customer_name}),e.jsx("td",{className:"px-4 py-3",children:t.payment_status==="paid"?e.jsx("span",{className:"text-slate-400",children:"-"}):e.jsx("span",{className:`${new Date(t.due_date)<new Date?"text-red-600 font-medium":"text-slate-700"}`,children:t.due_date})}),e.jsx("td",{className:"px-4 py-3",children:t.payment_receipt?e.jsx("span",{className:"text-green-600 font-medium",children:t.payment_receipt}):e.jsx("span",{className:"text-slate-400",children:"-"})}),e.jsx("td",{className:"px-4 py-3 text-right text-slate-900",children:parseFloat(t.net_amount||0).toFixed(2)}),e.jsx("td",{className:"px-4 py-3 text-right text-slate-900",children:parseFloat(t.ppn||0).toFixed(2)}),e.jsx("td",{className:"px-4 py-3 text-right font-semibold text-slate-900",children:parseFloat(t.total_amount||0).toFixed(2)})]},n)),p==="purchase_register"&&m.slice(0,100).map((t,n)=>e.jsxs("tr",{className:"hover:bg-slate-50",children:[e.jsx("td",{className:"px-4 py-3 text-slate-900",children:t.po_date}),e.jsx("td",{className:"px-4 py-3 text-slate-900",children:t.po_number}),e.jsx("td",{className:"px-4 py-3 text-slate-900",children:t.supplier_name}),e.jsx("td",{className:"px-4 py-3 text-right text-slate-900",children:parseFloat(t.net_amount||0).toFixed(2)}),e.jsx("td",{className:"px-4 py-3 text-right text-slate-900",children:parseFloat(t.ppn||0).toFixed(2)}),e.jsx("td",{className:"px-4 py-3 text-right font-semibold text-slate-900",children:parseFloat(t.total_amount||0).toFixed(2)}),e.jsx("td",{className:"px-4 py-3 text-slate-600",children:t.currency})]},n)),p==="cash_ledger"&&m.slice(0,100).map((t,n)=>e.jsxs("tr",{className:"hover:bg-slate-50",children:[e.jsx("td",{className:"px-4 py-3 text-slate-900",children:t.date}),e.jsx("td",{className:"px-4 py-3 text-slate-900",children:t.voucher_no}),e.jsx("td",{className:"px-4 py-3 text-slate-900",children:t.account_name}),e.jsx("td",{className:"px-4 py-3 text-right text-slate-900",children:parseFloat(t.debit||0).toFixed(2)}),e.jsx("td",{className:"px-4 py-3 text-right text-slate-900",children:parseFloat(t.credit||0).toFixed(2)}),e.jsx("td",{className:"px-4 py-3 text-slate-600",children:t.narration})]},n)),p==="bank_ledger"&&m.slice(0,100).map((t,n)=>e.jsxs("tr",{className:"hover:bg-slate-50",children:[e.jsx("td",{className:"px-4 py-3 text-slate-900",children:t.date}),e.jsx("td",{className:"px-4 py-3 text-slate-900",children:t.voucher_no}),e.jsx("td",{className:"px-4 py-3 text-slate-900",children:t.account_name}),e.jsx("td",{className:"px-4 py-3 text-right text-slate-900",children:parseFloat(t.debit||0).toFixed(2)}),e.jsx("td",{className:"px-4 py-3 text-right text-slate-900",children:parseFloat(t.credit||0).toFixed(2)}),e.jsx("td",{className:"px-4 py-3 text-slate-600",children:t.narration})]},n)),p==="journal_register"&&m.slice(0,100).map((t,n)=>e.jsxs("tr",{className:"hover:bg-slate-50",children:[e.jsx("td",{className:"px-4 py-3 text-slate-900",children:t.entry_date}),e.jsx("td",{className:"px-4 py-3 text-slate-900",children:t.entry_number}),e.jsx("td",{className:"px-4 py-3 text-slate-600",children:t.voucher_type}),e.jsx("td",{className:"px-4 py-3 text-slate-900 font-mono",children:t.account_code}),e.jsx("td",{className:"px-4 py-3 text-slate-900",children:t.account_name}),e.jsx("td",{className:"px-4 py-3 text-right text-slate-900",children:parseFloat(t.debit||0).toFixed(2)}),e.jsx("td",{className:"px-4 py-3 text-right text-slate-900",children:parseFloat(t.credit||0).toFixed(2)}),e.jsx("td",{className:"px-4 py-3 text-slate-600",children:t.narration})]},n)),p==="general_ledger"&&m.slice(0,100).map((t,n)=>e.jsxs("tr",{className:"hover:bg-slate-50",children:[e.jsx("td",{className:"px-4 py-3 text-slate-900 font-mono",children:t.account_code}),e.jsx("td",{className:"px-4 py-3 text-slate-900",children:t.account_name}),e.jsx("td",{className:"px-4 py-3 text-slate-900",children:t.entry_date}),e.jsx("td",{className:"px-4 py-3 text-slate-900",children:t.voucher_number}),e.jsx("td",{className:"px-4 py-3 text-right text-slate-900",children:parseFloat(t.debit||0).toFixed(2)}),e.jsx("td",{className:"px-4 py-3 text-right text-slate-900",children:parseFloat(t.credit||0).toFixed(2)}),e.jsx("td",{className:"px-4 py-3 text-slate-600",children:t.description})]},n)),p==="trial_balance"&&m.slice(0,100).map((t,n)=>e.jsxs("tr",{className:"hover:bg-slate-50",children:[e.jsx("td",{className:"px-4 py-3 text-slate-900 font-mono",children:t.code}),e.jsx("td",{className:"px-4 py-3 text-slate-900",children:t.name}),e.jsx("td",{className:"px-4 py-3 text-right text-slate-900",children:parseFloat(t.debit||0).toFixed(2)}),e.jsx("td",{className:"px-4 py-3 text-right text-slate-900",children:parseFloat(t.credit||0).toFixed(2)})]},n)),p==="fixed_assets"&&m.slice(0,100).map((t,n)=>e.jsxs("tr",{className:"hover:bg-slate-50",children:[e.jsx("td",{className:"px-4 py-3 text-slate-900 font-mono",children:t.asset_code}),e.jsx("td",{className:"px-4 py-3 text-slate-900",children:t.asset_name}),e.jsx("td",{className:"px-4 py-3 text-slate-900",children:t.acquisition_date}),e.jsx("td",{className:"px-4 py-3 text-right text-slate-900",children:t.cost}),e.jsx("td",{className:"px-4 py-3 text-right text-slate-900",children:t.accumulated_depreciation}),e.jsx("td",{className:"px-4 py-3 text-right text-slate-900",children:t.net_book_value})]},n))]})]}),m.length>100&&e.jsxs("div",{className:"text-center py-4 text-slate-500 text-sm",children:["Showing first 100 records. Export to Excel to see all ",m.length," records."]})]})]})]})}export{se as CAReports};
